## 变更概览（用户可见）
- 左侧驻守列表支持折叠/展开，并记住上次状态。
- 发送消息后、助手未回复前，聊天区显示“等待回复”动画提示。
- 历史对话记录名称可在列表中直接编辑并保存。
- 聊天输出消息按 Markdown 渲染（加粗、列表、链接、代码块等）。

## 实施方案

### 1) 左侧列表折叠/收起
- 位置：`app/chat/page.tsx:291-330`（侧栏 UI）
- 变更：
  - 在侧栏顶部加入一个折叠/展开按钮。
  - 使用 `useState` 管理 `sidebarCollapsed`，从 `localStorage` 初始化并在切换时持久化。
  - 折叠时侧栏最小化为窄把手（可点击展开）；展开时恢复原宽度。
- 用户体验：页面刷新后仍保持上次折叠状态；主聊天区自动适配宽度。

### 2) 回复等待动画
- 位置：发送与流处理：`app/chat/page.tsx:182-272`；消息区渲染：`416-455`
- 变更：
  - 发送消息后设置 `isAwaitingResponse=true`。
  - 在消息列表底部新增“助手正在回复…”的动画提示（简易 spinner 或三点跳动）。
  - 当收到 SSE 的首个片段或错误，置为 `false` 并移除提示。
- 用户体验：明确反馈助手正在思考/生成，不再“毫无表现”。

### 3) 历史对话重命名
- 位置：列表项：`app/chat/page.tsx:353-376`；API：`app/api/dify/conversations/route.ts:1-64`
- 变更：
  - 在每条对话右侧增加“编辑名称”按钮，点击进入行内编辑（输入框）。
  - 按 Enter 保存、Esc 取消；保存调用后端 `PATCH` 接口（传 `id` 与 `name`）。
  - 成功后更新当前项名称或刷新列表。
- 用户体验：无需跳转或弹窗即可改名，流畅直观。

### 4) Markdown 渲染
- 位置：消息渲染块：`app/chat/page.tsx:434-452`
- 变更：
  - 引入 `react-markdown` 与 `remark-gfm`（支持表格/任务列表等）。
  - 将 `message.content` 的纯文本渲染替换为 `<ReactMarkdown>`。
  - 为代码块与内联代码加样式（Tailwind），可选 `rehype-highlight` 做语法高亮。
- 用户体验：消息支持加粗、斜体、标题、列表、链接、代码块等 Markdown 语法，阅读更清晰。

## 验证
- 折叠：折叠/展开切换正常，刷新后状态保留。
- 动画：发送后立刻出现，收到回复或报错后消失。
- 重命名：编辑保存成功，列表立即显示新名称；错误时提示。
- Markdown：常见语法渲染正确，代码块样式清晰，链接可点击。

## 实施顺序
1. 左侧折叠功能（UI 与状态持久化）。
2. 等待动画（状态与渲染）。
3. 对话重命名（前端交互 + 后端 `PATCH`）。
4. Markdown 渲染（依赖引入 + 渲染替换 +样式）。